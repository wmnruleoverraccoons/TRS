<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Richter Scale - Focus Mode</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400&display=swap');

        body {
            background-color: #0f0f11;
            color: #f3f4f6;
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            height: 100vh; /* Volle Höhe des Viewports */
            height: 100dvh; /* Dynamic Viewport Height für Mobile Browser Bars */
            width: 100vw;
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent; /* Entfernt graue Box beim Tippen auf iPhone */
            
            /* Flexbox Zentrierung für den ganzen Body */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .serif { font-family: 'Playfair Display', serif; }

        .bg-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; overflow: hidden;
        }

        .blob {
            position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.5; transition: background-color 2s ease;
        }
        .blob-blue { width: 70vw; height: 70vw; background: #1e3a8a; top: -20%; left: -20%; }
        .blob-green { width: 60vw; height: 60vw; background: #064e3b; bottom: -10%; right: -10%; }

        /* Container ist jetzt absolut zentriert und hat eine feste maximale Breite */
        .story-container {
            position: relative;
            width: 85%; /* Breite für iPhone SE optimiert */
            max-width: 600px;
            height: auto;
            min-height: 200px; /* Reserviert Platz damit nichts springt */
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 10;
        }

        /* Die Textzeile */
        .line {
            position: absolute; /* Liegt übereinander, damit Ein/Ausblenden am gleichen Ort passiert */
            width: 100%;
            font-size: 1.4rem; /* Etwas größer für bessere Lesbarkeit */
            line-height: 1.5;
            opacity: 0;
            will-change: opacity, transform;
        }

        /* Mobile Anpassungen für iPhone SE */
        @media (max-width: 400px) {
            .line { font-size: 1.2rem; line-height: 1.4; }
            .blob { filter: blur(50px); } /* Performance auf alten Handys */
        }

        .line.dialogue { font-style: italic; color: #fff; text-shadow: 0 0 15px rgba(255,255,255,0.3); }
        .line.thought { color: #9ca3af; font-size: 1.1rem; letter-spacing: 0.02em; }

        /* UI */
        .chapter-mark {
            position: fixed; top: 2rem; width: 100%; text-align: center;
            font-size: 0.7rem; letter-spacing: 0.2em; text-transform: uppercase; opacity: 0.4;
            pointer-events: none;
        }

        .progress-bar {
            position: fixed; bottom: 0; left: 0; height: 3px; background: #ffffff; width: 0%; opacity: 0.5; transition: width 0.3s ease;
        }

        .hint {
            position: fixed; bottom: 3rem; width: 100%; text-align: center;
            font-size: 0.7rem; opacity: 0; animation: pulse 3s infinite; pointer-events: none;
        }
        @keyframes pulse { 0%, 100% { opacity: 0.1; } 50% { opacity: 0.5; } }

    </style>
</head>
<body>

    <div class="bg-container">
        <div class="blob blob-blue" id="blobBlue"></div>
        <div class="blob blob-green" id="blobGreen"></div>
    </div>

    <div class="chapter-mark serif" id="chapterTitle">Chapter 1</div>
    <div class="progress-bar" id="progressBar"></div>
    <div class="hint">Tap</div>

    <div class="story-container" id="story">
        </div>

    <script>
        // ==========================================
        // VOLLSTÄNDIGER TEXT (Satz für Satz)
        // ==========================================
        const chapterContent = [
// --- SCENE 1: BOSTON RUNNING ---
            { text: "Chapter One: 'How fast can you get to Zurich?'", type: "narrative", trigger: "calm" },
            { text: "Lucas Castro was running his usual morning loop along the Charles River, breath steady and even, while listening intently to a finance podcast he’d discovered the night before.", type: "narrative" },
            { text: "The Esplanade was quiet, and the city across the water was still wrapped in a soft haze that, Lucas knew, would burn off within the next half hour.", type: "narrative" },
            { text: "June mornings like this always felt like a gift to him, and as he split his attention between the podcast and thoughts about privilege,", type: "thought" },
            { text: "the audio cut out;", type: "narrative", trigger: "tension" },
            { text: "an incoming call.", type: "narrative", trigger: "tension" },
            { text: "He slowed his pace, glancing at the screen as he kept moving, now at a more relaxed jog. Jon Carver.", type: "narrative" },
            { text: "'Jon! One of my extra dads! What’s up?'", type: "dialogue" },
            { text: "Jon didn’t waste time. 'How fast can you get to Zurich?'", type: "dialogue" },
            { text: "The question made Lucas slow even more. He squinted, feeling the blood rush from his legs to his brain.", type: "narrative" },
            { text: "'Zurich? As in... Switzerland?'", type: "dialogue" },
            { text: "'There’s a leak', Jon said. 'Swiss news outlets got hold of internal documents.'", type: "dialogue" },
            { text: "'They’re spinning it as tax evasion, claiming I restructured assets to dodge obligations under the revised withholding regime.", type: "dialogue", trigger: "tension" },
            { text: "Lucas came to a full stop. The world didn’t. Bicycles sped past him, strollers rolled by, and behind it all the river shimmered innocently in the morning light. He focused instantly.", type: "narrative" },
            { text: "'Do they have anything actually criminal?'", type: "dialogue" },
            { text: "'Not even close. But it looks like someone cherry-picked just enough material to imply intent. Which means headlines and regulatory pressure.'", type: "dialogue" },
            { text: "'Swiss authorities?'", type: "dialogue" },
            { text: "'Not officially. No subpoenas or frozen assets, just speculation. But the documents are real; partial and out of context, but real. And someone had to leak them.'", type: "dialogue" },
            { text: "Lucas rubbed a hand over the back of his neck, eyes narrowing. 'So it’s not a legal emergency.'", type: "dialogue" },
            { text: "'No', Jon said calmly. 'It’s a reputational one.'", type: "dialogue" },
            { text: "'And reputational storms tend to attract regulators if you don't get ahead of them fast.'", type: "dialogue" },
            { text: "Lucas was already turning back, jogging now. 'What exactly do you want from me?'", type: "dialogue" },
            { text: "'I want a clean, internal reconstruction of what they saw, and what they didn’t. You know the structures. You’re not on any boards. And you can still sit in a meeting without people second-guessing your presence.'", type: "dialogue" },
            { text: "Lucas’s mouth twitched. Jon’s version of trust.", type: "thought" },
            { text: "'You think someone did this deliberately.'", type: "dialogue" },
            { text: "'I don’t believe in accidents', Jon said. 'Not ones this well timed.'", type: "dialogue" },
            { text: "'I covered EU tax structure last spring', Lucas replied quietly. 'The exam was a nightmare, my only 90% ever.'", type: "dialogue" },
            { text: "'He exhaled heavily. 'What about Singapore? London? Any spillover?'", type: "dialogue" },
            { text: "'All secure. This is just Switzerland, and for now, just headlines; that’s why Ari is needed, too. But I want to know who fed them the story.'", type: "dialogue" },
            { text: "Lucas didn’t need to hear more, grinning at the thought of Ari, Jon’s husband. He’d already pivoted, heading back toward Beacon Street, blood rushing louder in his ears now than any river or city noise.", type: "narrative", trigger: "chaos" },
            { text: "'There’s one flight left tonight', he said, pulling it up mid-jog. 'Boston to Zurich, nonstop. First class only.'", type: "dialogue" },
            { text: "Jon didn't hesitate.'Book it. We’ll meet you there.'", type: "dialogue" },
            { text: "The line went dead. Lucas slowed just long enough to catch his breath. Not from exhaustion; he hadn't even finished his loop.", type: "narrative" },
            { text: "This wasn’t only about helping family. It was about proving he was useful. Lucas immediately picked up his pace.", type: "thought" },
            { text: "I can fix this.", type: "thought", trigger: "tension" },
        ];

        // ==========================================
        // LOGIK
        // ==========================================

        let currentIndex = 0;
        const storyDiv = document.getElementById('story');
        const progressBar = document.getElementById('progressBar');
        const blobBlue = document.getElementById('blobBlue');
        const blobGreen = document.getElementById('blobGreen');

        // Initiale Blob Animation
        gsap.to(".blob", { y: "10%", duration: 8, repeat: -1, yoyo: true, ease: "sine.inOut" });
        gsap.to("#blobGreen", { x: "-10%", duration: 10, repeat: -1, yoyo: true, ease: "sine.inOut", delay: 1 });

        // Event Listeners
        document.addEventListener('click', showNextLine);
        document.addEventListener('keydown', (e) => {
            if(e.code === 'Space' || e.code === 'ArrowRight') showNextLine();
        });

        function showNextLine() {
            if (currentIndex >= chapterContent.length) return;

            const data = chapterContent[currentIndex];
            const oldLine = storyDiv.querySelector('.line');

            // 1. Altes Element entfernen (falls vorhanden)
            if (oldLine) {
                gsap.to(oldLine, {
                    opacity: 0,
                    y: -20, // Bewegt sich leicht nach oben beim Verschwinden
                    duration: 0.3,
                    onComplete: () => oldLine.remove()
                });
            }

            // 2. Neues Element erstellen
            const p = document.createElement('p');
            p.className = `line serif ${data.type || 'narrative'}`;
            p.innerText = data.text;
            storyDiv.appendChild(p);

            // 3. Neues Element animieren
            gsap.fromTo(p, 
                { opacity: 0, y: 20 }, // Kommt leicht von unten
                { opacity: 1, y: 0, duration: 0.6, ease: "power2.out", delay: 0.2 } // Kleines Delay damit der alte Text weg ist
            );

            // 4. Trigger Effekte
            if (data.trigger) triggerEffect(data.trigger);

            // 5. Progress
            currentIndex++;
            const progress = (currentIndex / chapterContent.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        function triggerEffect(triggerName) {
            switch(triggerName) {
                case 'tension':
                    gsap.to(blobBlue, { backgroundColor: "#172554", scale: 1.1, duration: 2 });
                    gsap.to(blobGreen, { backgroundColor: "#022c22", scale: 0.9, duration: 2 });
                    break;
                case 'closer':
                    gsap.to(blobBlue, { x: 50, y: 50, duration: 3 });
                    gsap.to(blobGreen, { x: -50, y: -50, duration: 3 });
                    break;
                case 'kiss':
                    gsap.to(".blob", { mixBlendMode: "screen", duration: 0.5 });
                    gsap.to(blobBlue, { scale: 1.3, backgroundColor: "#3b82f6" });
                    gsap.to(blobGreen, { scale: 1.3, backgroundColor: "#10b981" });
                    break;
                case 'chaos':
                    gsap.to(blobGreen, { x: "random(-100, 100)", y: "random(-100, 100)", duration: 0.5, yoyo: true, repeat: 3 });
                    break;
                case 'heat':
                    gsap.to(blobBlue, { backgroundColor: "#4c1d95", duration: 2 });
                    gsap.to(blobGreen, { backgroundColor: "#be123c", duration: 2 });
                    break;
                case 'calm':
                    gsap.to(blobBlue, { x: 0, y: 0, scale: 1, backgroundColor: "#1e3a8a", duration: 2 });
                    gsap.to(blobGreen, { x: 0, y: 0, scale: 1, backgroundColor: "#064e3b", duration: 2 });
                    gsap.to(".blob", { mixBlendMode: "normal", duration: 2 });
                    break;
            }
        }
    </script>
</body>
</html>